
-- Sample Queries for Airport Management System

-- 1. SELECT NAME AND SALARY FROM EMPLOYEE HAVING PHONE NUMBER
SELECT E.NAME, E.SALARY
FROM EMPLOYEE E
WHERE E.E_ID IN (
    SELECT EP.E_ID
    FROM EMP_PHONE_NO EP
    WHERE EP.E_ID = E.E_ID
);

-- 2. SELECT NAME AND SALARY AND ID IN WHICH E_ID IS BETWEEN 1 TO 5 having phone number
SELECT E.E_ID, E.NAME, E.SALARY
FROM EMPLOYEE E
WHERE E.E_ID IN (
    SELECT EP.E_ID
    FROM EMP_PHONE_NO EP
    WHERE EP.E_ID BETWEEN 1 AND 5
);

-- 3. SELECT NAME BASED ON AIRPORT_NAME WHERE CITY IS MUMBAI
SELECT E.NAME, E.E_ID
FROM EMPLOYEE E
WHERE E.AIRPORT_NAME IN (
    SELECT A.AIRPORT_NAME
    FROM AIRPORT A
    WHERE A.CITY = 'Mumbai'
);

-- 4. SELECT NAME AND SEX WHERE EMPLOYEE ID IS GREATER THAN 3 AND HAVING PHONE NUMBER
SELECT E.E_ID, E.NAME, E.SEX
FROM EMPLOYEE E
WHERE E.E_ID IN (
    SELECT EP.E_ID
    FROM EMP_PHONE_NO EP
    WHERE EP.E_ID >= 3
);

-- 5. SELECT EMPLOYEE NAME, ID HAVING MULTIPLE PHONE NUMBERS
SELECT E.NAME, E.E_ID
FROM EMPLOYEE E
WHERE E.E_ID IN (
    SELECT EP.E_ID
    FROM EMP_PHONE_NO EP
    GROUP BY EP.E_ID
    HAVING COUNT(*) > 1
);

-- 6. SELECT NAME, ADDRESS, AGE, SEX WHERE CITY IS Mumbai or Delhi
SELECT E.NAME, E.ADDRESS, E.AGE, E.SEX
FROM EMPLOYEE E
WHERE E.AIRPORT_NAME IN (
    SELECT A.AIRPORT_NAME
    FROM AIRPORT A
    WHERE A.CITY IN ('Mumbai', 'Delhi')
);

-- 7. SELECT NAME, PASSPORT NUMBER OF PASSENGERS WHERE AIRLINE_NAME IS Mumbai Airlines
SELECT P.NAME, P.PASSPORT_NO
FROM PASSENGER P
WHERE P.TICKET_NO IN (
    SELECT T.TICKET_NO
    FROM TICKET T
    WHERE T.AIRLINE_NAME = 'Mumbai Airlines'
);

-- 8. SELECT AIRPORT NAME WHERE NUMBER OF EMPLOYEES GREATER THAN 1
SELECT AIRPORT_NAME
FROM EMPLOYEE
GROUP BY AIRPORT_NAME
HAVING COUNT(*) > 1;

-- 9. FIND PASSENGERS BOOKED ON A PARTICULAR FLIGHT (example flight number: 12345)
SELECT NAME, PASSPORT_NO
FROM PASSENGER
WHERE FLIGHT_NO = 12345;

-- 10. FIND NUMBER OF PASSENGERS ON A PARTICULAR FLIGHT
SELECT FLIGHT_NO, COUNT(*) AS passenger_count
FROM PASSENGER
GROUP BY FLIGHT_NO;

-- 11. SELECT EMPLOYEES SERVING A PARTICULAR PASSENGER (example passport number: '123')
SELECT E.E_ID, E.NAME
FROM EMPLOYEE E
JOIN SERVES S ON E.E_ID = S.E_ID
WHERE S.PASSPORT_NO = '123';

-- 12. SELECT PASSENGERS SERVED BY A PARTICULAR EMPLOYEE (example employee ID: 13)
SELECT P.PASSPORT_NO, P.NAME
FROM PASSENGER P
JOIN SERVES S ON P.PASSPORT_NO = S.PASSPORT_NO
WHERE S.E_ID = 13;

-- 13. SELECT ALL FLIGHTS OPERATED BY A PARTICULAR AIRLINE (example airline ID: 123)
SELECT FLIGHT_NO, SOURCE, DESTINATION, D_TIME, A_TIME
FROM FLIGHT
WHERE AIRLINE_ID = 123;

-- 14. FIND EMPLOYEES WHO WORK AT AN AIRPORT WITH LESS THAN 3 EMPLOYEES
SELECT E.*
FROM EMPLOYEE E
WHERE E.AIRPORT_NAME IN (
    SELECT AIRPORT_NAME
    FROM EMPLOYEE
    GROUP BY AIRPORT_NAME
    HAVING COUNT(*) < 3
);

-- 15. GET A LIST OF ALL PASSENGERS WHO HAVE MORE THAN ONE PHONE NUMBER
SELECT PASSPORT_NO
FROM PASSENGER_PHONE_NO
GROUP BY PASSPORT_NO
HAVING COUNT(*) > 1;

-- 16. LIST ALL FLIGHTS BETWEEN TWO DATES
SELECT *
FROM FLIGHT
WHERE D_TIME BETWEEN '2022-02-20' AND '2022-02-25';

-- 17. LIST TICKETS FOR PASSENGERS WHOSE AGE IS ABOVE 60
SELECT T.*
FROM TICKET T
JOIN PASSENGER P ON T.PASSPORT_NO = P.PASSPORT_NO
WHERE P.AGE > 60;

-- 18. FIND AIRLINES OPERATING FROM A PARTICULAR CITY (example: 'Mumbai')
SELECT DISTINCT A.AIRLINE_NAME
FROM AIRLINE A
JOIN AIRPORT AP ON A.AIRPORT_NAME = AP.AIRPORT_NAME
WHERE AP.CITY = 'Mumbai';

-- 19. FIND TOTAL TICKETS SOLD BY EACH AIRLINE
SELECT AIRLINE_NAME, COUNT(*) AS tickets_sold
FROM TICKET
GROUP BY AIRLINE_NAME;

-- 20. FIND TOTAL REVENUE GENERATED BY EACH AIRLINE
SELECT AIRLINE_NAME, SUM(PRICE) AS total_revenue
FROM TICKET
GROUP BY AIRLINE_NAME;
